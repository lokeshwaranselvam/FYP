<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Carbon Emission Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="container">

        <h1>Carbon Emission Analyzer</h1>
        <p class="subtitle">
            Sales Excel → AI Classification → CO₂ Estimation & Reduction Suggestions
        </p>

        <!-- File Upload -->
        <div class="upload-box">
            <label for="fileInput" class="upload-btn">Select Excel File</label>
            <input type="file" id="fileInput" accept=".csv,.xls,.xlsx" hidden>
            <p id="fileName">No file selected</p>
        </div>

        <!-- Total Emission -->
        <div class="card-container">
            <div class="card">
                <strong>Total CO₂</strong>
                <p id="totalEmission">0 kg</p>
            </div>
        </div>

        <!-- Summary Cards -->
        <div class="summary-grid">
            <div class="card summary-card">
                <h3>Total Units</h3>
                <p id="totalUnits">0</p>
            </div>
            <div class="card summary-card">
                <h3>Avg Emission/Unit</h3>
                <p id="avgEmission">0 kg</p>
            </div>
            <div class="card summary-card">
                <h3>Highest Impact Item</h3>
                <p id="highestImpact" style="font-size: 0.9em;">-</p>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Pie Chart -->
            <div class="card chart-card">
                <h3>Emission by Category</h3>
                <div class="chart-container">
                    <canvas id="emissionChart"></canvas>
                </div>
            </div>

            <!-- Bar Chart -->
            <div class="card chart-card">
                <h3>Emission by Source</h3>
                <div class="chart-container">
                    <canvas id="sourceChart"></canvas>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- AI Suggestions -->
            <div class="llm-box" style="flex: 1;">
                <h3>AI Recommendations & Risk Analysis</h3>
                <ul id="suggestionList">
                    <li>Upload a file to generate suggestions.</li>
                </ul>
                <span class="llm-note">
                    Powered by Local Carbon Recommender Engine
                </span>
            </div>
        </div>

        <!-- Government Report -->
        <div class="report-box" id="reportBox" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3>Government Compliance Report (High-Risk Items)</h3>
                <button id="exportBtn" class="export-btn">Export CSV</button>
            </div>
            <table class="report-table">
                <thead>
                    <tr>
                        <th>Product ID</th>
                        <th>Product</th>
                        <th>Source</th>
                        <th>Total Emission (kg)</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="reportTableBody">
                    <!-- Rows injected by JS -->
                </tbody>
            </table>
        </div>

        <button class="analyze-btn" disabled>
            Analyze Carbon Emission
        </button>

    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>

</html>